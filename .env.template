# =============================================================================
# AI Agent Platform - Environment Configuration Template
# =============================================================================
# Copy this file to .env and fill in the values.
# NEVER commit .env to version control - it contains secrets!
# =============================================================================

# -----------------------------------------------------------------------------
# REQUIRED SECRETS (must be set before deployment)
# -----------------------------------------------------------------------------

# PostgreSQL database credentials
# Generate password: openssl rand -hex 16
POSTGRES_USER=postgres
POSTGRES_PASSWORD=<generate-with-openssl-rand-hex-16>
POSTGRES_DB=agent

# User credential encryption key (CRITICAL for production)
# Encrypts stored OAuth tokens and API keys in the database
# Generate: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
AGENT_CREDENTIAL_ENCRYPTION_KEY=<generate-fernet-key>

# SearxNG session secret
# Generate: openssl rand -hex 32
SEARXNG_SECRET=<generate-with-openssl-rand-hex-32>

# Open WebUI session secret
# Generate: openssl rand -hex 32
OPENWEBUI_SECRET=<generate-with-openssl-rand-hex-32>

# -----------------------------------------------------------------------------
# Agent Service Configuration
# -----------------------------------------------------------------------------

# Environment: development | production | test
AGENT_ENVIRONMENT=development

# Server binding
AGENT_HOST=0.0.0.0
AGENT_PORT=8000

# LiteLLM connection
AGENT_LITELLM_API_BASE=http://litellm:4000
AGENT_LITELLM_MODEL=ollama/llama3.1:8b
AGENT_LITELLM_API_KEY=

# Qdrant vector database
AGENT_QDRANT_URL=http://qdrant:6333
AGENT_QDRANT_COLLECTION=agent-memories
AGENT_QDRANT_API_KEY=

# Web fetcher service
AGENT_WEBFETCH_URL=http://webfetch:8081

# SQLite state path (for local state)
AGENT_SQLITE_STATE_PATH=data/agent_state.sqlite

# CORS allowed origins (comma-separated)
# Empty = CORS disabled (secure default)
# Example: http://localhost:3000,https://your-domain.com
AGENT_CORS_ALLOWED_ORIGINS=

# -----------------------------------------------------------------------------
# Domain and SSL Configuration (Traefik + Let's Encrypt)
# -----------------------------------------------------------------------------

# Your public domain (production)
DOMAIN=agent.example.com

# Development domain (for Traefik-exposed dev environment)
# Optional: Set this to expose dev stack via Traefik alongside prod
# Example: agent-dev.example.com
DOMAIN_DEV=agent-dev.example.com

# Email for Let's Encrypt notifications (certificate expiry warnings)
ACME_EMAIL=admin@example.com

# -----------------------------------------------------------------------------
# Azure DevOps Integration (optional)
# -----------------------------------------------------------------------------

AZURE_DEVOPS_ORG=<your-organization>
AZURE_DEVOPS_PROJECT=<your-project>
# Generate PAT at: https://dev.azure.com/<org>/_usersSettings/tokens
AZURE_DEVOPS_PAT=<your-personal-access-token>

# -----------------------------------------------------------------------------
# Homey OAuth Integration (optional)
# -----------------------------------------------------------------------------

# Register OAuth client at: https://tools.developer.homey.app/
AGENT_HOMEY_OAUTH_ENABLED=false
AGENT_HOMEY_AUTHORIZATION_URL=https://api.athom.com/oauth2/authorise
AGENT_HOMEY_TOKEN_URL=https://api.athom.com/oauth2/token
AGENT_HOMEY_CLIENT_ID=<your-homey-oauth-client-id>
AGENT_HOMEY_CLIENT_SECRET=<your-homey-oauth-client-secret>
AGENT_OAUTH_REDIRECT_URI=https://your-domain.com/auth/oauth/callback

# Homey MCP (Model Context Protocol)
HOMEY_MCP_URL=https://mcp.athom.com/sse
HOMEY_API_TOKEN=<your-homey-api-token>

# -----------------------------------------------------------------------------
# Microsoft Entra ID (Azure AD) Authentication
# -----------------------------------------------------------------------------

# Create App Registration at: https://portal.azure.com/#view/Microsoft_AAD_RegisteredApps
# Required redirect URI: http://localhost:3000/oauth/microsoft/callback
MICROSOFT_CLIENT_ID=<your-azure-app-client-id>
MICROSOFT_CLIENT_SECRET=<your-azure-app-client-secret>
MICROSOFT_CLIENT_TENANT_ID=<your-azure-tenant-id>

# -----------------------------------------------------------------------------
# Email Notifications (optional)
# -----------------------------------------------------------------------------

# Resend API for email notifications
# Get API key at: https://resend.com/
AGENT_RESEND_API_KEY=
AGENT_PRICE_TRACKER_FROM_EMAIL=no-reply@your-domain.com

# -----------------------------------------------------------------------------
# External API Keys (optional)
# -----------------------------------------------------------------------------

# OpenRouter for additional LLM providers
OPENROUTER_API_KEY=

# -----------------------------------------------------------------------------
# Container Images (pinned versions for reproducibility)
# -----------------------------------------------------------------------------

LITELLM_IMAGE=ghcr.io/berriai/litellm@sha256:6eb7f8bdc47baf3aa07d3d7b2ddc330662ed28811a2a03ba32c8a548809f30e3
OLLAMA_IMAGE=ollama/ollama@sha256:e8c3d1f6ad16323bc40dc63eff0701d4fc32113f75a86b54b3e836eef8290de6
OPENWEBUI_IMAGE=ghcr.io/open-webui/open-webui@sha256:53a4d2fc8c7a7cc620cd18e6fe416ed9940f2db87fddf837e3aa55111bec6995
SEARXNG_IMAGE=searxng/searxng@sha256:d477c0460cc06afa57541f24c7adcae3846303a125c3ae785b9893c9c2c2186f

# -----------------------------------------------------------------------------
# Ports
# -----------------------------------------------------------------------------

OPENWEBUI_PORT=3000
LITELLM_PORT=4000
QDRANT_PORT=6333
OLLAMA_PORT=11434
SEARXNG_PORT=8080
FETCHER_PORT=8081
EMBEDDER_PORT=8082

# -----------------------------------------------------------------------------
# Retrieval Configuration
# -----------------------------------------------------------------------------

ENABLE_QDRANT=true
QDRANT_TOP_K=5
MMR_LAMBDA=0.7
ENABLE_RAG=true
RAG_MAX_SOURCES=5
RAG_MAX_CHARS=1200

# -----------------------------------------------------------------------------
# Miscellaneous
# -----------------------------------------------------------------------------

# Timezone for logging and scheduling
TIMEZONE=Europe/Stockholm

# Docker Compose project name
COMPOSE_PROJECT_NAME=ai-agent-platform
STACK_PROJECT_NAME=ai-agent-platform

# Open WebUI internal API key (for agent communication)
OPENWEBUI_OPENAI_API_KEY=agent-local

# Docker build settings (BuildKit enabled for faster builds)
DOCKER_BUILDKIT=1
COMPOSE_DOCKER_CLI_BUILD=1
