# =============================================================================
# AI Agent Platform - Environment Configuration Template
# =============================================================================
# Copy this file to .env and fill in the values.
# NEVER commit .env to version control - it contains secrets!
# =============================================================================

# -----------------------------------------------------------------------------
# REQUIRED SECRETS (must be set before deployment)
# -----------------------------------------------------------------------------

# PostgreSQL database credentials
# Generate password: openssl rand -hex 16
POSTGRES_USER=postgres
POSTGRES_PASSWORD=<generate-with-openssl-rand-hex-16>
POSTGRES_DB=agent_db

# PostgreSQL connection URL (used by agent service for database connection)
# Auto-constructed in docker-compose, override if needed for external DB
POSTGRES_URL=postgresql+asyncpg://postgres:${POSTGRES_PASSWORD}@postgres:5432/agent_db

# User credential encryption key (CRITICAL for production)
# Encrypts stored OAuth tokens and API keys in the database
# Generate: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
AGENT_CREDENTIAL_ENCRYPTION_KEY=<generate-fernet-key>

# Agent API authentication keys (CRITICAL for production)
# These protect agent endpoints, admin dashboard, and diagnostic APIs
# Generate each: openssl rand -hex 32
AGENT_INTERNAL_API_KEY=<generate-with-openssl-rand-hex-32>
AGENT_ADMIN_API_KEY=<generate-with-openssl-rand-hex-32>
AGENT_DIAGNOSTIC_API_KEY=<generate-with-openssl-rand-hex-32>

# Admin portal JWT session secret
# Generate: openssl rand -hex 32
AGENT_ADMIN_JWT_SECRET=<generate-with-openssl-rand-hex-32>

# SearxNG session secret
# Generate: openssl rand -hex 32
SEARXNG_SECRET=<generate-with-openssl-rand-hex-32>

# Open WebUI session secret
# Generate: openssl rand -hex 32
OPENWEBUI_SECRET=<generate-with-openssl-rand-hex-32>

# -----------------------------------------------------------------------------
# Agent Service Configuration
# -----------------------------------------------------------------------------

# Environment: development | production | test
AGENT_ENVIRONMENT=development

# Server binding (internal to container)
AGENT_HOST=0.0.0.0
AGENT_PORT=8000

# LiteLLM connection
AGENT_LITELLM_API_BASE=http://litellm:4000
AGENT_LITELLM_MODEL=ollama/llama3.1:8b
AGENT_LITELLM_API_KEY=

# Qdrant vector database
AGENT_QDRANT_URL=http://qdrant:6333
AGENT_QDRANT_COLLECTION=agent-memories
AGENT_QDRANT_API_KEY=

# Qdrant connection (legacy aliases used by modules/rag and modules/indexer)
QDRANT_URL=http://qdrant:6333
QDRANT_COLLECTION=agent-memories

# Web fetcher service (internal)
AGENT_WEBFETCH_URL=http://webfetch:8081

# SearxNG search engine (used by modules/fetcher for web search)
SEARXNG_URL=http://searxng:8080

# Skills directory (mounted in docker-compose)
# Default: /app/skills (inside container)
SKILLS_DIR=/app/skills

# Workspace base directory for git clones
# Used by git_clone tool for context-isolated repository workspaces
# Default: /tmp/agent-workspaces
AGENT_WORKSPACE_BASE=/tmp/agent-workspaces

# CORS allowed origins (comma-separated)
# Empty = CORS disabled (secure default)
# Example: http://localhost:3000,https://your-domain.com
AGENT_CORS_ALLOWED_ORIGINS=

# -----------------------------------------------------------------------------
# Domain and SSL Configuration (Traefik + Let's Encrypt)
# -----------------------------------------------------------------------------

# Your public domain (production)
DOMAIN=agent.example.com

# Development domain (for Traefik-exposed dev environment)
# Optional: Set this to expose dev stack via Traefik alongside prod
# Example: agent-dev.example.com
DOMAIN_DEV=agent-dev.example.com

# Email for Let's Encrypt notifications (certificate expiry warnings)
ACME_EMAIL=admin@example.com

# -----------------------------------------------------------------------------
# Azure DevOps Integration (optional)
# -----------------------------------------------------------------------------

AZURE_DEVOPS_ORG=<your-organization>
AZURE_DEVOPS_PROJECT=<your-project>
# Generate PAT at: https://dev.azure.com/<org>/_usersSettings/tokens
AZURE_DEVOPS_PAT=<your-personal-access-token>
# Optional: Full organization URL (defaults to https://dev.azure.com/{AZURE_DEVOPS_ORG})
# AZURE_DEVOPS_ORG_URL=https://dev.azure.com/your-org

# -----------------------------------------------------------------------------
# Homey OAuth Integration (optional)
# -----------------------------------------------------------------------------

# Register OAuth client at: https://tools.developer.homey.app/
AGENT_HOMEY_OAUTH_ENABLED=false
AGENT_HOMEY_AUTHORIZATION_URL=https://api.athom.com/oauth2/authorise
AGENT_HOMEY_TOKEN_URL=https://api.athom.com/oauth2/token
AGENT_HOMEY_CLIENT_ID=<your-homey-oauth-client-id>
AGENT_HOMEY_CLIENT_SECRET=<your-homey-oauth-client-secret>
AGENT_OAUTH_REDIRECT_URI=https://your-domain.com/auth/oauth/callback

# -----------------------------------------------------------------------------
# Microsoft Entra ID (Azure AD) Authentication
# -----------------------------------------------------------------------------

# Create App Registration at: https://portal.azure.com/#view/Microsoft_AAD_RegisteredApps
# Required redirect URIs:
#   - http://localhost:3000/oauth/microsoft/callback (local dev)
#   - https://your-domain.com/oauth/microsoft/callback (production)
MICROSOFT_CLIENT_ID=<your-azure-app-client-id>
MICROSOFT_CLIENT_SECRET=<your-azure-app-client-secret>
MICROSOFT_CLIENT_TENANT_ID=<your-azure-tenant-id>

# -----------------------------------------------------------------------------
# Email Notifications (optional)
# -----------------------------------------------------------------------------

# Resend API for email notifications
# Get API key at: https://resend.com/
AGENT_RESEND_API_KEY=
AGENT_EMAIL_FROM_ADDRESS=no-reply@your-domain.com

# Deprecated: Use AGENT_EMAIL_FROM_ADDRESS instead
# AGENT_PRICE_TRACKER_FROM_EMAIL=no-reply@your-domain.com

# Price tracker check interval (hours)
AGENT_PRICE_TRACKER_CHECK_INTERVAL_HOURS=6

# -----------------------------------------------------------------------------
# External API Keys (optional)
# -----------------------------------------------------------------------------

# OpenRouter for additional LLM providers
OPENROUTER_API_KEY=

# GitHub Personal Access Token (for creating PRs)
# Generate at: https://github.com/settings/tokens
# GITHUB_TOKEN=ghp_xxx

# Context7 MCP Integration (optional)
# AGENT_CONTEXT7_MCP_URL=http://context7:8080/sse
# AGENT_CONTEXT7_API_KEY=<your-context7-api-key>

# -----------------------------------------------------------------------------
# Vector Search Configuration
# -----------------------------------------------------------------------------

# Qdrant retrieval settings
QDRANT_TOP_K=5
MMR_LAMBDA=0.7

# -----------------------------------------------------------------------------
# Container Images (pinned versions for reproducibility)
# -----------------------------------------------------------------------------

# Only SEARXNG_IMAGE is used (others are hardcoded in docker-compose.yml)
SEARXNG_IMAGE=searxng/searxng@sha256:d477c0460cc06afa57541f24c7adcae3846303a125c3ae785b9893c9c2c2186f

# -----------------------------------------------------------------------------
# Port Configuration
# -----------------------------------------------------------------------------

# Only SEARXNG_PORT is used (for docker-compose.override.yml)
# Other ports are hardcoded in docker-compose files
SEARXNG_PORT=8080

# -----------------------------------------------------------------------------
# Docker Build Configuration
# -----------------------------------------------------------------------------

# Stack project name (used by stack CLI)
STACK_PROJECT_NAME=ai-agent-platform

# Docker BuildKit settings (faster builds)
DOCKER_BUILDKIT=1
COMPOSE_DOCKER_CLI_BUILD=1
