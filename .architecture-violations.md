# Architecture Violations Report

Generated: 2026-02-07

## Summary

The architecture validator detected **14 violations** of the 4-layer architecture rules.

All violations are in the **interfaces layer** directly importing from **modules/** instead of going through **orchestrator/**.

## Rule Violated

**Interface layer dependencies**: interfaces/ should not import modules/ directly (use orchestrator/)

## Violations by File

### interfaces/http/admin_price_tracker.py (7 violations)

- Line 36: `modules.price_tracker.models`
- Line 37: `modules.price_tracker.parser`
- Line 38: `modules.price_tracker.service`
- Line 219: `modules.price_tracker.models`
- Line 375: `modules.price_tracker.models`
- Line 727: `modules.price_tracker.models`
- Line 905: `modules.price_tracker.models`

### interfaces/http/app.py (7 violations)

- Line 331: `modules.embedder`
- Line 332: `modules.fetcher`
- Line 333: `modules.indexer`
- Line 334: `modules.rag`
- Line 434: `modules.email.service`
- Line 447: `modules.price_tracker.scheduler`
- Line 459: `modules.homey.scheduler`

## Recommended Fix

Refactor these files to access modules through the orchestrator layer:

1. Create orchestrator services that wrap the module functionality
2. Update interfaces to import from orchestrator instead of modules directly
3. Use dependency injection where appropriate

## Temporary Workaround

The architecture validator can be temporarily skipped during `stack check` by using:

```bash
stack check --skip-architecture
```

Or when deploying/publishing (currently auto-skipped in deploy and repo publish commands).

## Goal

Fix these violations in a future PR to ensure full compliance with the 4-layer architecture:

```
interfaces/ → orchestrator/ → modules/ → core/
```
