# n8n Workflows

This directory contains exported n8n workflows for the agent platform.

## Sync workflows

Use the stack CLI (`poetry run stack …`) to backup/restore workflows from the
running n8n instance (`python scripts/stack_tools.py …` remains as a wrapper):

```bash
# Export all workflows from container to repo
poetry run stack n8n export

# Import workflows from repo into a (clean) n8n instance
poetry run stack n8n import

# Include credentials (stored in flows/credentials.json)
poetry run stack n8n export --include-credentials
poetry run stack n8n import --include-credentials
```

- `flows/workflows/` contains one JSON per workflow (auto-generated by export).
- `flows/workflows.json` aggregates all workflows as a reference.

> Edit workflows directly in the n8n UI, then run `export` so git stays in sync.

### Credentials policy

- Credentials are excluded from the repo by default (`flows/credentials.json` is gitignored).
- Only include credentials with the explicit `-IncludeCredentials` flag and commit with care. Prefer environment-based secrets or n8n’s encrypted store for sensitive values.

## Workflow: Agent Echo

- File: `flows/workflows/agent-echo--1.json`
- Webhook: `POST /webhook/agent`
- Purpose: Acknowledges incoming `agent.echo` and returns the received args with timestamp.
